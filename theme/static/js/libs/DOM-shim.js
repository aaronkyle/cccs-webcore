(function(){window.M8={data:{}};(function(){function o(e,t){var n=e.split("/").slice(0,-1);while(t.slice(0,3)==="../"){n=n.slice(0,-1);t=t.slice(3)}return n.concat(t.split("/")).join("/")}function u(t,u){return function(a){var f,l,c,h;if(e.logging>=4){console.debug("modul8: "+t+":"+u+" <- "+a)}if(a.slice(0,2)==="./"){l=[t];a=o(u,a.slice(2))}else if(a.slice(0,3)==="../"){l=[t];a=o(u,a)}else if(s.test(a)){l=[a.match(s)[1]];a=a.split("::")[1]}else if(r.indexOf(a)>=0){l=["M8"]}else{l=[t].concat(n.filter(function(e){return e!==t}))}a=a.split(".")[0];if(a.slice(-1)==="/"||a===""){a+="index";h=true}if(e.logging>=3){console.log("modul8: "+t+":"+u+" <- "+a)}if(e.logging>=4){console.debug("modul8: scanned "+JSON.stringify(l))}for(c=0;c<l.length;c+=1){f=l[c];if(i[f][a]){return i[f][a]}if(!h&&i[f][a+"/index"]){return i[f][a+"/index"]}}if(e.logging>=1){console.error("modul8: Unable to resolve require for: "+a)}}}var e={namespace:"M8",domains:["app","shims","all","utils"],arbiters:{},logging:1},t=window[e.namespace],n=e.domains,r=[],i={},s=/^([\w]*)::/;i.M8={};i.external={};i.data=t.data;delete t.data;n.forEach(function(e){i[e]={}});Object.keys(e.arbiters).forEach(function(t){var n=e.arbiters[t];r.push(t);i.M8[t]=window[n[0]];n.forEach(function(e){delete window[e]})});t.define=function(e,t,n){var r={};n(u(t,e),r,i[t][e]={});if(r.exports){delete i[t][e];i[t][e]=r.exports}};t.inspect=function(e){console.log(i[e])};t.domains=function(){return n.concat(["external","data"])};t.require=u("app","CONSOLE");t.data=function(e,t){if(i.data[e]){delete i.data[e]}if(t){i.data[e]=t}};t.external=function(e,t){if(i.external[e]){delete i.external[e]}if(t){i.external[e]=t}}})();M8.define("index","utils",function(e,t,n){function s(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];var o=t(i);if(o){return o}if(i.childNodes&&i.childNodes.length){var o=s(i.childNodes,t);if(o){return o}}}}function o(e){var t=Object.create(DOMException.prototype);t.code=e;throw t}function u(e,t,n){Object.keys(e).forEach(function(s){if(s==="constants"){var o=e[s];Object.keys(o).forEach(function(t){if(!r.call(n,t)){n[t]=o[t]}});return}if(!r.call(t,s)){var u=e[s];if(u.value){u.writable=false}else{}u.configurable=true;u.enumerable=false;Object.defineProperty(t,s,u)}})}function a(e,t,n){t=t||e.ownerDocument;var r;if(e.nodeType===Node.ELEMENT_NODE){var i=e.nodeName;if(e.prefix){i=e.prefix+":"+i}r=t.createElementNS(e.namespaceURI,i);for(var s=0,o=e.attributes.length;s<o;s++){var u=e.attributes[s];r.setAttribute(u.name,u.value)}}else if(e.nodeType===Node.DOCUMENT_NODE){r=t.implementation.createDocument("","",null)}else if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){r=t.createDocumentFragment()}else if(e.nodeType===Node.DOCUMENT_TYPE_NODE){r=t.implementation.createDocumentType(e.name,e.publicId,e.systemId)}else if(e.nodeType===Node.COMMENT_NODE){r=t.createComment(e.data)}else if(e.nodeType===Node.TEXT_NODE){r=t.createTextNode(e.data)}else if(e.nodeType===Node.PROCESSING_INSTRUCTION_NODE){r=t.createProcessingInstruction(e.target,e.data)}if(n){var a=e.childNodes;for(var s=0,o=a.length;s<o;s++){r.appendChild(a[s].cloneNode(e,t,n))}}return r}var r=Object.prototype.hasOwnProperty;var i=["HTMLDocument","HTMLLinkElement","HTMLElement","HTMLHtmlElement","HTMLDivElement","HTMLAnchorElement","HTMLSelectElement","HTMLOptionElement","HTMLInputElement","HTMLHeadElement","HTMLSpanElement","XULElement","HTMLBodyElement","HTMLTableElement","HTMLTableCellElement","HTMLTextAreaElement","HTMLScriptElement","HTMLAudioElement","HTMLMediaElement","HTMLParagraphElement","HTMLButtonElement","HTMLLIElement","HTMLUListElement","HTMLFormElement","HTMLHeadingElement","HTMLImageElement","HTMLStyleElement","HTMLTableRowElement","HTMLTableSectionElement","HTMLBRElement"];t.exports={addShimToInterface:u,throwDOMException:o,clone:a,recursivelyWalk:s,HTMLNames:i}});M8.define("interfaces/DOMTokenList","all",function(e,t,n){function s(e,t){this._getString=e;this._setString=t;o(this,e().split(" "))}function o(e,t){for(var n=0,r=t.length;n<r;n++){e[n]=t[n]}delete e[r]}function u(e){if(e===""||e===undefined){i(DOMException.SYNTAX_ERR)}if(e.indexOf(" ")>-1){i(DOMException.INVALID_CHARACTER_ERR)}}function a(e){var t=e._getString();if(t===""){return[]}else{return t.split(" ")}}function f(e){if(e>=this.length){return null}return this._getString().split(" ")[e]}function l(e){u(e);var t=a(this);return t.indexOf(e)>-1}function c(e){u(e);var t=a(this);if(t.indexOf(e)>-1){return}t.push(e);this._setString(t.join(" ").trim());o(this,t)}function h(e){u(e);var t=a(this);var n=t.indexOf(e);if(n>-1){t.splice(n,1);this._setString(t.join(" ").trim())}o(this,t)}function p(e){if(this.contains(e)){this.remove(e);return false}else{this.add(e);return true}}function d(){return this._getString()}var r=e("utils::index");var i=r.throwDOMException;t.exports={constructor:s,item:f,contains:l,add:c,remove:h,toggle:p,toString:d};t.exports.constructor.prototype=t.exports});M8.define("interfaces/DOMSettableTokenList","all",function(e,t,n){function s(e,t){i.call(this,e,t)}var r=e("utils::index"),i=e("interfaces/DOMTokenList").constructor;t.exports={constructor:s};t.exports.constructor.prototype=t.exports;(function(t,n){(t.prototype=Object.create(n.prototype)).constructor=t})(s,i);Object.defineProperty(s.prototype,"value",{enumerable:true,get:function(){return this._getString()},set:function(e){return this._setString(e)}})});M8.define("interfaces/CustomEvent","shims",function(e,t,n){function r(e,t){var n=document.createEvent("CustomEvent");t=t||{};t.detail=t.detail||null;t.bubbles=t.bubbles||false;t.catchable=t.catchable||false;if(n.initCustomEvent){n.initCustomEvent(e,t.bubbles,t.catchable,t.detail)}else{n.initEvent(e,t.bubbles,t.catchable);n.detail=t.detail}return n}t.exports={constructor:r,"interface":window.Event}});M8.define("interfaces/Element","shims",function(e,t,n){function i(){var e=this.parentNode;if(e==null){return null}if(e.nodeType===Node.ELEMENT_NODE){return e}return null}function s(){var e=this;if(this._classList){return this._classList}else{var t=new r(function(){return e.className||""},function(n){e.className=n});this._classList=t;return t}}var r=e("all::interfaces/DOMTokenList").constructor;t.exports={parentElement:{get:i},classList:{get:s}}});M8.define("interfaces/Event","shims",function(e,t,n){function r(e,t){var n=document.createEvent("Events");t=t||{};t.bubbles=t.bubbles||false;t.catchable=t.catchable||false;n.initEvent(e,t.bubbles,t.catchable);return n}t.exports={constructor:r}});M8.define("interfaces/EventTarget","shims",function(e,t,n){t.exports={"interface":window.Node||window.Element}});M8.define("interfaces/Node","shims",function(e,t,n){function r(e){var t=this.compareDocumentPosition(e);if(t===0||t&Node.DOCUMENT_POSITION_CONTAINED_BY){return true}return false}t.exports={contains:{value:r},"interface":window.Element}});M8.define("interfaces/index","shims",function(e,t,n){t.exports={CustomEvent:e("./CustomEvent"),Element:e("./Element"),Event:e("./Event"),EventTarget:e("./EventTarget"),Node:e("./Node")}});M8.define("bugs","shims",function(e,t,n){function i(){(function(){var e=document.createElement("div");try{document.importNode(e)}catch(e){var t=document.importNode;delete document.importNode;document.importNode=function(n,r){if(r===undefined){r=true}return t.call(this,n,r)}}})();(function(){function n(e){window[e]&&i(window[e].prototype)}function i(e){var t=e.cloneNode;delete e.cloneNode;e.cloneNode=function(n){if(n===undefined){n=true}return t.call(this,n)}}var e=document.createElement("p");try{e.cloneNode()}catch(t){[Node.prototype,Comment.prototype,Element.prototype,ProcessingInstruction.prototype,Document.prototype,DocumentType.prototype,DocumentFragment.prototype].forEach(i);r.HTMLNames.forEach(n)}})();(function(){var e=0;var t=function(){e++};document.addEventListener("click",t);var n=new Event("click");document.dispatchEvent(n);if(e===0){var r=EventTarget.prototype.addEventListener;EventTarget.prototype.addEventListener=function(e,t,n){n=n||false;return r.call(this,e,t,n)};var i=EventTarget.prototype.removeEventListener;EventTarget.prototype.removeEventListener=function(e,t,n){n=n||false;return i.call(this,e,t,n)};window.addEventListener=EventTarget.prototype.addEventListener;window.removeEventListener=EventTarget.prototype.removeEventListener}document.removeEventListener("click",t)})()}var r=e("utils::index");t.exports=i});(function(){M8.define("utils/index","app",function(e,t,n){function s(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];var o=t(i);if(o){return o}if(i.childNodes&&i.childNodes.length){var o=s(i.childNodes,t);if(o){return o}}}}function o(e){var t=Object.create(DOMException.prototype);t.code=e;throw t}function u(e,t,n){Object.keys(e).forEach(function(s){if(s==="constants"){var o=e[s];Object.keys(o).forEach(function(t){if(!r.call(n,t)){n[t]=o[t]}});return}if(!r.call(t,s)){var u=e[s];if(u.value){u.writable=false}else{}u.configurable=true;u.enumerable=false;Object.defineProperty(t,s,u)}})}function a(e,t,n){t=t||e.ownerDocument;var r;if(e.nodeType===Node.ELEMENT_NODE){var i=e.nodeName;if(e.prefix){i=e.prefix+":"+i}r=t.createElementNS(e.namespaceURI,i);for(var s=0,o=e.attributes.length;s<o;s++){var u=e.attributes[s];r.setAttribute(u.name,u.value)}}else if(e.nodeType===Node.DOCUMENT_NODE){r=t.implementation.createDocument("","",null)}else if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE){r=t.createDocumentFragment()}else if(e.nodeType===Node.DOCUMENT_TYPE_NODE){r=t.implementation.createDocumentType(e.name,e.publicId,e.systemId)}else if(e.nodeType===Node.COMMENT_NODE){r=t.createComment(e.data)}else if(e.nodeType===Node.TEXT_NODE){r=t.createTextNode(e.data)}else if(e.nodeType===Node.PROCESSING_INSTRUCTION_NODE){r=t.createProcessingInstruction(e.target,e.data)}if(n){var a=e.childNodes;for(var s=0,o=a.length;s<o;s++){r.appendChild(a[s].cloneNode(e,t,n))}}return r}var r=Object.prototype.hasOwnProperty;var i=["HTMLDocument","HTMLLinkElement","HTMLElement","HTMLHtmlElement","HTMLDivElement","HTMLAnchorElement","HTMLSelectElement","HTMLOptionElement","HTMLInputElement","HTMLHeadElement","HTMLSpanElement","XULElement","HTMLBodyElement","HTMLTableElement","HTMLTableCellElement","HTMLTextAreaElement","HTMLScriptElement","HTMLAudioElement","HTMLMediaElement","HTMLParagraphElement","HTMLButtonElement","HTMLLIElement","HTMLUListElement","HTMLFormElement","HTMLHeadingElement","HTMLImageElement","HTMLStyleElement","HTMLTableRowElement","HTMLTableSectionElement","HTMLBRElement"];t.exports={addShimToInterface:u,throwDOMException:o,clone:a,recursivelyWalk:s,HTMLNames:i}});M8.define("main","app",function(e,t,n){var r=e("shims::interfaces"),i=e("utils");Object.keys(r).forEach(function(t){var n=r[t];var s=window[t];if(!s){s=window[t]=n.interface}delete n.interface;var o=s.prototype;if(n.prototype){o=s.prototype=n.prototype;delete n.prototype}console.log("adding interface ",t);if(n.hasOwnProperty("constructor")){window[t]=s=n.constructor;n.constructor.prototype=o;delete n.constructor}i.addShimToInterface(n,o,s)});e("shims::bugs")()})})()})()